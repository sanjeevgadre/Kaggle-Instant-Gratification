---
title: "Part I - EDA and LC"
author: "Sanjeev Gadre"
date: "September 24, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = TRUE)
```

Loading the required libraries

```{r libraries}
library(dplyr)
library(ggplot2)
library(ff)
library(ffbase)

```

Loading utility functions

```{r utilitity-functions}
save.ffdf(train, dir = "../RDA/traindir", overwrite = TRUE)
save.ffdf(test, dir = "../RDA/testdir", overwrite = TRUE)

train = load.ffdf(dir = "../RDA/traindir")
    train = train[["train"]]
    open.ffdf(train)
test = load.ffdf(dir = "../RDA/testdir")
    test = test[["test"]]
    open.ffdf(test)
```

Loading data

```{r get-data}
train = read.csv.ffdf(file = "../data/train.csv")
test = read.csv.ffdf(file = "../data/test.csv")
n.train = nrow(train)
n.test = nrow(test)
p.train = ncol(train)

```

EDA - I

```{r eda-1}
colnames.train = colnames(train[,])
writeLines("The column names for the train dataset are:\n")
colnames.train

writeLines("\nSample values from the first column of the train dataset:\n")
head(train[,1]); tail(train[,1])
writeLines("\nSample values from the last column of the train dataset:\n")
head(train[, 258]); tail(train[, 258])
```

1.  The first column is `id`. The values of this column don't show any discernable patterns.
2.  The last column is `target` and represents the classification lable value {0, 1}
3.  We ascertain if there are any NA values either in the *train* or the *test* subset.


```{r eda-2}
train.na.data = sapply(physical(train), function(x){sum(is.na(x))})
test.na.data = sapply(physical(train), function(x){sum(is.na(x))})

writeLines("Columns in the train dataset reporting NA values\n")
train.na.data[train.na.data != 0]
writeLines("\nColumns in the test dataset reporting NA values\n")
train.na.data[train.na.data != 0]

```

1.  There are no NA values in either the *train* or the *test* dataset.
2.  We look for the proportion of the two labels in the *train* dataset.
3.  We look for co-relation amongst the columns of the *train* dataset
3.  We save the `ffdf` datasets for future use.

```{r eda-3}
writeLines("The proportion of the two labels in the train datset is:")
table(train[, "target"]) %>% prop.table() %>% round(digits = 4)

```

1.  The two categories are almost equally represented in the *train* dataset.
2.  We add a dummy `target` column to the *test* dataset and then combine the *train* and *test* dataset.
3.  We scale the combined dataset and then re-split them into two separate datasets

```{r baseline-1}
test$target = as.ff(rep(0, times = n.test))
dat = ffdfappend(train, test) # Equivalent of rbind
rm(test, train)
gc()

dat.scaled = as.ffdf(sapply(dat[, 2:257], scale))

save.ffdf(train, dir = "../RDA/traindir", overwrite = TRUE)
save.ffdf(test, dir = "../RDA/testdir", overwrite = TRUE)

rm(list = ls())
gc()
```

